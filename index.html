<html>
	<head>

	</head>
	<body>
		<script src="jquery-2.1.1.min.js"></script>
		<script src="./class/GPlayer.js"></script>
		<script src="./class/GCandy.js"></script>
		<script src="./class/GMap.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<link rel="stylesheet" type="text/css" href="./css/style.css"/>
		<script>

			var socket 	= io.connect('http://localhost:8080'),
				gmap		= null;

			socket.emit('connection', '');

			socket.on('gameConfiguration', function(datas){
				gmap = new GMap($("#GameMap"), $("#MapWrapper"), $("#GameInfo"));
				gmap.squareHeight	= datas.squareHeight;
				gmap.squareWidth 	= datas.squareWidth;
				gmap.squareSize 	= datas.squareSize;
				gmap.draw();
				printCandies(datas.candies, gmap);
				printPlayers(datas.players, gmap);
			});

			socket.on('sendYourName', function(){
				$('#NameForm').submit(function(event){
					event.preventDefault();
					socket.emit('playerName', $('input[type=text]').val());
				});
			});

			socket.on('newPlayer', function(datas){
				console.info('new player in game', datas);
			});

			socket.on('gameFull', function(datas){

			});

			socket.on('tenSecondsCountdown', function(datas){

			});

			socket.on('candiesPosition', function(datas){

			});

			socket.on('readySteadyGo', function(datas){

			});

			// Main program
			//var game =null;
			$(document).ready(function(){
				$(document).keydown(function(e) {
				    switch(e.which) {
				        case 37: // left
							socket.emit('playerMove', 'left');break;
				        case 38: // up
							socket.emit('playerMove', 'up');break;
				        case 39: // right
							socket.emit('playerMove', 'right');break;
				        case 40: // down
							socket.emit('playerMove', 'down');break;
				        default: return;
				    }
				    e.preventDefault();
				});
			});

			function printCandies(candies, gmap){
				for(var i=0 ; i<candies.length ; i++){
					var tmp = new GCandy(candies[i].id, candies[i].xCoord, candies[i].yCoord, candies[i].state);
					gmap.mapHtml.append(tmp.getHtml());
					gmap.candies.push(tmp);
					tmp.draw(gmap.squareSize);
				}
			}

			function printPlayers(){

			}

		</script>

		<div id="MenuWrapper">
			<form id="NameForm" action="#">
				<br/>
				<span style="color:white;font-size:18px;">Enter your name</span>
				<br/><br/>
				<input type="text" class="Input"/>
				<br/>
				<input type="submit" class="Button"/>
				<br/>
			</form>
		</div>

		<div id="GameWrapper">
			<div id="MapWrapper">
				<div id="GameMap"></div>
			</div>
			<div id="GameInfo"></div>
		</div>
	</body>
</html>
